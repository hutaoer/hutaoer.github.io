(window.webpackJsonp=window.webpackJsonp||[]).push([[136],{532:function(t,a,s){"use strict";s.r(a);var v=s(3),_=Object(v.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"大前端故障总结"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#大前端故障总结"}},[t._v("#")]),t._v(" 大前端故障总结")]),t._v(" "),a("ul",[a("li",[t._v("针对业务场景中的前端故障进行分析和总结，防微杜渐，已经隐去了业务敏感信息。")]),t._v(" "),a("li",[t._v("总结\n"),a("ul",[a("li",[t._v("能回滚的时候，及时回滚，减少资损。后端设计接口的时候，需要做好版本兼容。尤其是涉及到APP、小程序的发版，具有一定的不同版本共存的时间。")]),t._v(" "),a("li",[t._v("复制的代码需要做好评估，理解代码的功能，慎重使用。")]),t._v(" "),a("li",[t._v("上线前，做好代码 "),a("code",[t._v("diff")]),t._v("和"),a("code",[t._v("Code Review")]),t._v("，"),a("code",[t._v("勿因善小而不为")]),t._v("。")])])])]),t._v(" "),a("h2",{attrs:{id:"华为手机无法获取验证码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#华为手机无法获取验证码"}},[t._v("#")]),t._v(" 华为手机无法获取验证码")]),t._v(" "),a("h3",{attrs:{id:"影响"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#影响"}},[t._v("#")]),t._v(" 影响")]),t._v(" "),a("ul",[a("li",[t._v("1人")])]),t._v(" "),a("h3",{attrs:{id:"描述"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#描述"}},[t._v("#")]),t._v(" 描述")]),t._v(" "),a("ul",[a("li",[t._v("用户登录的时候，无法获取验证码。")])]),t._v(" "),a("h3",{attrs:{id:"原因"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#原因"}},[t._v("#")]),t._v(" 原因")]),t._v(" "),a("ul",[a("li",[t._v("发布海心医生华为应用市场时，打包过程中版本号修改错误，把"),a("code",[t._v("A5.5.2")]),t._v("写成了"),a("code",[t._v("5.5.2")]),t._v("，医生端发送验证码接口对请求"),a("code",[t._v("header")]),t._v("中的"),a("code",[t._v("appversion")]),t._v("做了格式验证，如果不是"),a("code",[t._v("A")]),t._v("或者"),a("code",[t._v("I")]),t._v("开头的就进行拦截，导致发送验证码接口请求失败。")])]),t._v(" "),a("h3",{attrs:{id:"解决"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#解决"}},[t._v("#")]),t._v(" 解决")]),t._v(" "),a("ul",[a("li",[t._v("后期引入自动升级版本号，避免手写的误差。")]),t._v(" "),a("li",[t._v("后端接口修改，兼容不带字母的版本号格式。")])]),t._v(" "),a("h2",{attrs:{id:"小程序社区tab无法点击"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#小程序社区tab无法点击"}},[t._v("#")]),t._v(" 小程序社区tab无法点击")]),t._v(" "),a("h3",{attrs:{id:"影响-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#影响-2"}},[t._v("#")]),t._v(" 影响")]),t._v(" "),a("ul",[a("li",[t._v("pv: 7000+")]),t._v(" "),a("li",[t._v("uv: 500+")])]),t._v(" "),a("h3",{attrs:{id:"描述-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#描述-2"}},[t._v("#")]),t._v(" 描述")]),t._v(" "),a("ul",[a("li",[t._v("患者端小程序首页，内容瀑布流中的内容无法点击。")])]),t._v(" "),a("h3",{attrs:{id:"原因-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#原因-2"}},[t._v("#")]),t._v(" 原因")]),t._v(" "),a("ul",[a("li",[t._v("本地开发的时候，为了让小程序编译快一点， 把 "),a("code",[t._v("app.config.js")]),t._v(" 里面的部分路径给注释了，发布生产的时候，忘记恢复代码，导致生产环境，部分路径无法跳转。")])]),t._v(" "),a("h3",{attrs:{id:"解决-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#解决-2"}},[t._v("#")]),t._v(" 解决")]),t._v(" "),a("ul",[a("li",[t._v("直接在小程序后台操作回滚上个版本，然后再紧急发布一个版本修复问题。")])]),t._v(" "),a("h3",{attrs:{id:"教训"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#教训"}},[t._v("#")]),t._v(" 教训")]),t._v(" "),a("ul",[a("li",[t._v("尽量不要改需求之外的代码，如果有，需要在需求评估中罗列，比如修改配置文件，公共组件等。")]),t._v(" "),a("li",[t._v("每次代码commit的时候，做好diff，养成习惯。")]),t._v(" "),a("li",[t._v("每次合并分支的时候，做好diff")]),t._v(" "),a("li",[t._v("代码上线前，做好Code Review和 diff")])]),t._v(" "),a("h2",{attrs:{id:"ios-手机输入框无法输入问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ios-手机输入框无法输入问题"}},[t._v("#")]),t._v(" iOS 手机输入框无法输入问题")]),t._v(" "),a("h3",{attrs:{id:"现象"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#现象"}},[t._v("#")]),t._v(" 现象")]),t._v(" "),a("ul",[a("li",[t._v("iOS 手机下，H5活动页面，输入框无法输入。")])]),t._v(" "),a("h3",{attrs:{id:"原因-3"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#原因-3"}},[t._v("#")]),t._v(" 原因")]),t._v(" "),a("ul",[a("li",[t._v("为了支持微信环境下长按识别图片的能力，复用了其他项目中的公共样式，该样式在iOS设备下不兼容，导致输入框无法聚焦，从而无法输入内容。")]),t._v(" "),a("li",[t._v("本地测试的时候，活动页没有使用到input标签，所以测试的时候没有复现。但对其他的页面造成了影响。")]),t._v(" "),a("li",[t._v("复制的时候，黏贴的css代码如下：")])]),t._v(" "),a("div",{staticClass:"language-css extra-class"},[a("pre",{pre:!0,attrs:{class:"language-css"}},[a("code",[a("span",{pre:!0,attrs:{class:"token selector"}},[t._v("*")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token property"}},[t._v("-webkit-touch-callout")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" none"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*系统默认菜单被禁用*/")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token property"}},[t._v("-webkit-user-select")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" none"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*webkit浏览器*/")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token property"}},[t._v("-khtml-user-select")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" none"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*早期浏览器*/")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token property"}},[t._v("-moz-user-select")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" none"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*火狐*/")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token property"}},[t._v("-ms-user-select")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" none"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*IE10*/")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token property"}},[t._v("user-select")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" none"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h3",{attrs:{id:"教训-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#教训-2"}},[t._v("#")]),t._v(" 教训")]),t._v(" "),a("ul",[a("li",[t._v("未充分自测")]),t._v(" "),a("li",[t._v("未对复制的代码做好评估，而直接使用")]),t._v(" "),a("li",[t._v("使用了全局的样式")])]),t._v(" "),a("h2",{attrs:{id:"小程序生产环境调用了预发接口"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#小程序生产环境调用了预发接口"}},[t._v("#")]),t._v(" 小程序生产环境调用了预发接口")]),t._v(" "),a("h3",{attrs:{id:"影响-3"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#影响-3"}},[t._v("#")]),t._v(" 影响")]),t._v(" "),a("ul",[a("li",[t._v("时长：10小时")])]),t._v(" "),a("h3",{attrs:{id:"现象-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#现象-2"}},[t._v("#")]),t._v(" 现象")]),t._v(" "),a("ul",[a("li",[t._v("C端患者小程序，在某个需求上线后，后端监控到大量的预发接口调用日志。")])]),t._v(" "),a("h3",{attrs:{id:"原因-4"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#原因-4"}},[t._v("#")]),t._v(" 原因")]),t._v(" "),a("ul",[a("li",[t._v("小程序的提审，跟部署后台是隔离的，存在一定的时间差。部署后台中，小程序只构建了tag后，没有点击开始发布，完成构建流程，就在微信后台提交了审核版本，导致提交的其实是预发环境的体验版（预发环境的代码）。")])]),t._v(" "),a("h3",{attrs:{id:"改进"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#改进"}},[t._v("#")]),t._v(" 改进")]),t._v(" "),a("ul",[a("li",[t._v("需要严格按照部署流程来操作，并在部署后台进行交互修改，来提示操作人员。")]),t._v(" "),a("li",[t._v("通过流程来约束。")]),t._v(" "),a("li",[t._v("通过完全自动化的方式来执行部署和提审。")])]),t._v(" "),a("h2",{attrs:{id:"患教计划功能无法正常使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#患教计划功能无法正常使用"}},[t._v("#")]),t._v(" 患教计划功能无法正常使用")]),t._v(" "),a("h3",{attrs:{id:"影响-4"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#影响-4"}},[t._v("#")]),t._v(" 影响")]),t._v(" "),a("ul",[a("li",[t._v("个案无法创建患教计划")])]),t._v(" "),a("h3",{attrs:{id:"原因-5"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#原因-5"}},[t._v("#")]),t._v(" 原因")]),t._v(" "),a("ul",[a("li",[t._v("在项目开发的时候因为项目跑不起来， 并把项目文件里面的 "),a("code",[t._v("node_modules")]),t._v(" 、"),a("code",[t._v("package-lock.json")]),t._v(" 删除， 并重新进行 "),a("code",[t._v("npm install")]),t._v(" 。")]),t._v(" "),a("li",[t._v("因为项目里面"),a("code",[t._v("package.json")]),t._v(" 的依赖，某个二方包使用的是 "),a("code",[t._v("^0.2.19")]),t._v(" 版本， 但是正是因为 "),a("code",[t._v("^")]),t._v("的原因，导致会安装依赖的时候进行小版本的更新 变成 "),a("code",[t._v('"version": "0.2.35"')]),t._v(", 升级的版本功能较多，且没有在本个版本中进行测试。")]),t._v(" "),a("li",[t._v("其中，就引入了埋点功能，且埋点SDK，是通过CDN方式引入的，而本项目中没有引入，就导致了埋点SDK报错了。")])]),t._v(" "),a("h3",{attrs:{id:"改进-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#改进-2"}},[t._v("#")]),t._v(" 改进")]),t._v(" "),a("ul",[a("li",[t._v("开发二方包的时候，没有严格执行npm版本的升级规则，对于breaking change，需要大版本，否则会导致兼容问题。")]),t._v(" "),a("li",[t._v("package-lock文件的删除过于随意，需要慎重，最好是进行diff。而不是直接删除。")]),t._v(" "),a("li",[t._v("对于二方包的引入，需要锁定版本。")])]),t._v(" "),a("h2",{attrs:{id:"antd-版本升级问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#antd-版本升级问题"}},[t._v("#")]),t._v(" antd 版本升级问题")]),t._v(" "),a("h3",{attrs:{id:"描述-3"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#描述-3"}},[t._v("#")]),t._v(" 描述")]),t._v(" "),a("ul",[a("li",[t._v("技改的时候，对antd版本进行升级，但评估不够全面，导致一些页面的使用问题。")])]),t._v(" "),a("h3",{attrs:{id:"原因-6"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#原因-6"}},[t._v("#")]),t._v(" 原因")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("antd")]),t._v("的官方平台有绝大部分对于影响点有所说明， 但是由于我们个案管理平台是在"),a("code",[t._v("pad")]),t._v("上面使用的， 所以在一些情况下面存在样式和使用的问题。但也遗漏了部分升级说明，比如"),a("code",[t._v("Textarea")]),t._v("的使用，在 "),a("code",[t._v("4.x")]),t._v(" 中，有不兼容的情况。")]),t._v(" "),a("li",[t._v("日期选择框， 时间选择框 升级到 4 版本后会点击会导致弹出虚拟键盘， 而在版本 3 中则不会， 影响到用户的使用情况\n"),a("ul",[a("li",[t._v("解决：需要在 "),a("code",[t._v("DatePicker、 RangePicker")]),t._v(" 对应加上 "),a("code",[t._v("inputReadOnly")]),t._v(" 属性， 禁止掉虚拟键盘")])])]),t._v(" "),a("li",[a("code",[t._v("Textarea")]),t._v(" 使用"),a("code",[t._v("ref.current.state")]),t._v(" 使用报错，因为在state上一层多了一个包裹对象，导致输入框输入报错,无法赋值。\n"),a("ul",[a("li",[t._v("解决：")])])])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("curRef"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("current"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("value "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" nextProps"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("defaultValue "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Error")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("curRef"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("current"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("resizableTextArea"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("value "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" nextProps"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("defaultValue "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//success")]),t._v("\n")])])]),a("ul",[a("li",[t._v("组件dom层级不一致\n"),a("ul",[a("li",[t._v("解决：需要修改其类名名称， 类名的层级结构， 修改css样式 和 默认的css 样式")])])])]),t._v(" "),a("h3",{attrs:{id:"改进-3"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#改进-3"}},[t._v("#")]),t._v(" 改进")]),t._v(" "),a("ol",[a("li",[t._v("技改系分影响系分，以及对于影响点的全面评估，")]),t._v(" "),a("li",[t._v("影响点一级用例全量测试")]),t._v(" "),a("li",[t._v("监控ErrorBoundary 捕获异常并上报")]),t._v(" "),a("li",[t._v("测试整理用例并培训")]),t._v(" "),a("li",[t._v("修改问题影响点需要同步到相关开发测试同学")])]),t._v(" "),a("h2",{attrs:{id:"小程序订单页面不可访问"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#小程序订单页面不可访问"}},[t._v("#")]),t._v(" 小程序订单页面不可访问")]),t._v(" "),a("h3",{attrs:{id:"影响-5"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#影响-5"}},[t._v("#")]),t._v(" 影响")]),t._v(" "),a("ul",[a("li",[t._v("订单页面不可用时长：2小时")])]),t._v(" "),a("h3",{attrs:{id:"原因-7"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#原因-7"}},[t._v("#")]),t._v(" 原因")]),t._v(" "),a("ul",[a("li",[t._v("订单页面域名迁移，新域名没有在小程序后台配置。")]),t._v(" "),a("li",[t._v("测试的时候，打开了调试模式，所以没有发现该问题。")])]),t._v(" "),a("h3",{attrs:{id:"改进-4"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#改进-4"}},[t._v("#")]),t._v(" 改进")]),t._v(" "),a("ul",[a("li",[t._v("小程序验收的时候，在预发环境，需要关闭调试模式。")]),t._v(" "),a("li",[t._v("发布"),a("code",[t._v("checklist")]),t._v("中，增加域名的白名单验证。")])]),t._v(" "),a("h2",{attrs:{id:"小程序线上环境访问api非生产环境"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#小程序线上环境访问api非生产环境"}},[t._v("#")]),t._v(" 小程序线上环境访问API非生产环境")]),t._v(" "),a("h3",{attrs:{id:"影响-6"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#影响-6"}},[t._v("#")]),t._v(" 影响")]),t._v(" "),a("ul",[a("li",[t._v("生产环境访问其他环境的API时长：40分钟。")])]),t._v(" "),a("h3",{attrs:{id:"原因-8"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#原因-8"}},[t._v("#")]),t._v(" 原因")]),t._v(" "),a("ul",[a("li",[t._v("架构组对小程序进行技改，且未跟当天有发布的外包同学同步。导致发布的时候，使用的是其他环境的代码。")]),t._v(" "),a("li",[t._v("且直接在master分支提交的代码，没有走正常的部署流程。")])]),t._v(" "),a("h3",{attrs:{id:"解决-3"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#解决-3"}},[t._v("#")]),t._v(" 解决")]),t._v(" "),a("ul",[a("li",[t._v("小程序代码回滚")])]),t._v(" "),a("h3",{attrs:{id:"改进-5"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#改进-5"}},[t._v("#")]),t._v(" 改进")]),t._v(" "),a("ul",[a("li",[t._v("建立小程序发布群，及时同步当天的发布信息和版本")]),t._v(" "),a("li",[t._v("严格执行小程序的部署流程，禁用master分支的push提交权限。")]),t._v(" "),a("li",[t._v("规范测试流程，线下、测试、预发、线上，都需要进行API环境、功能的回归测试。")])])])}),[],!1,null,null,null);a.default=_.exports}}]);