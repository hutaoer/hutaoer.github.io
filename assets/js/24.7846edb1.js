(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{388:function(t,s,a){"use strict";a.r(s);var n=a(45),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"taro-2-0-商城项目总结"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#taro-2-0-商城项目总结"}},[t._v("#")]),t._v(" Taro 2.0 商城项目总结")]),t._v(" "),a("h2",{attrs:{id:"技术选型"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#技术选型"}},[t._v("#")]),t._v(" 技术选型")]),t._v(" "),a("ul",[a("li",[t._v("商城的主要业务场景包括商城APP，APP内嵌H5，微信小程序，和微信H5，大部分H5页面是三端（APP, 微信H5，小程序）统一的，所以跨端的框架是首选。")]),t._v(" "),a("li",[t._v("结合团队的情况，"),a("code",[t._v("React")]),t._v("技术栈为主，2020年的时候，Taro 3.0 还是beta 版，所以选用了 Taro 2.0 作为技术栈。")]),t._v(" "),a("li",[t._v("数据管理使用 "),a("code",[t._v("dva")])]),t._v(" "),a("li",[t._v("部署的话，是将打包后代码，直接部署在云主机上。")])]),t._v(" "),a("h2",{attrs:{id:"项目目录结构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#项目目录结构"}},[t._v("#")]),t._v(" 项目目录结构")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("config")]),t._v(": 配置相关的文件，包括基础配置、不同环境的自定义配置、路由信息配置。")]),t._v(" "),a("li",[a("code",[t._v("dist")]),t._v(": 项目打包后的物料目录，根据"),a("code",[t._v("H5")]),t._v("和"),a("code",[t._v("小程序")]),t._v("，最终会生成两个不同的目录，"),a("code",[t._v("h5")]),t._v("和"),a("code",[t._v("weapp")]),t._v("。")]),t._v(" "),a("li",[a("code",[t._v("mock")]),t._v(": 由于没有搭建mock服务，可以临时在本地启一个mock服务，用来调试代码。")]),t._v(" "),a("li",[a("code",[t._v("src")]),t._v(": 核心代码目录，目录比较多，分别进行描述。\n"),a("ul",[a("li",[a("code",[t._v("src/assets")]),t._v(": 存放静态资源文件，主要以图片为主。")]),t._v(" "),a("li",[a("code",[t._v("src/components")]),t._v(": 通用业务组件目录，超过2个页面会使用的组件，具备通用能力的组件，都会被提取到这个目录。")]),t._v(" "),a("li",[a("code",[t._v("src/constants")]),t._v(": 存放常量。")]),t._v(" "),a("li",[a("code",[t._v("src/models")]),t._v(": 存放页面数据，安装不同的页面进行区分。")]),t._v(" "),a("li",[a("code",[t._v("src/service")]),t._v(": ajax请求封装。")]),t._v(" "),a("li",[a("code",[t._v("src/styles")]),t._v(": 基础样式目录。")]),t._v(" "),a("li",[a("code",[t._v("src/utils")]),t._v(": 工具函数封装。")]),t._v(" "),a("li",[a("code",[t._v("src/pages")]),t._v(": 主包业务代码目录。主包的概念来自小程序，最大不能超过20M。如果超过了20M，可以进行拆包或者打包优化。")])])])]),t._v(" "),a("h3",{attrs:{id:"页面目录结构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#页面目录结构"}},[t._v("#")]),t._v(" 页面目录结构")]),t._v(" "),a("ul",[a("li",[t._v("以首页为例")]),t._v(" "),a("li",[a("code",[t._v("src/pages/home/index.js")]),t._v(": 入口文件")]),t._v(" "),a("li",[a("code",[t._v("src/pages/home/components/")]),t._v(": 首页用到的组件目录")]),t._v(" "),a("li",[a("code",[t._v("src/pages/home/index.scss")]),t._v(": 样式文件")]),t._v(" "),a("li",[a("code",[t._v("src/pages/home/model.js")]),t._v(": 数据")]),t._v(" "),a("li",[a("code",[t._v("src/pages/home/service.js")]),t._v(": 首页接口请求")])]),t._v(" "),a("h2",{attrs:{id:"ajax-封装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ajax-封装"}},[t._v("#")]),t._v(" ajax 封装")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("ajax")]),t._v("请求是基于"),a("code",[t._v("Taro.request")])])]),t._v(" "),a("h3",{attrs:{id:"常见请求状态码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#常见请求状态码"}},[t._v("#")]),t._v(" 常见请求状态码")]),t._v(" "),a("ul",[a("li",[t._v("文件目录："),a("code",[t._v("src/constants/status.js")])])]),t._v(" "),a("h4",{attrs:{id:"http-状态码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#http-状态码"}},[t._v("#")]),t._v(" HTTP 状态码")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("HTTP_STATUS")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("SUCCESS")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("200")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("CREATED")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("201")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("ACCEPTED")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("202")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("NO_CONTENT")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("204")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("CLIENT_ERROR")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("400")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("UNAUTHORIZED")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("401")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("FORBIDDEN")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("403")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("NOT_FOUND")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("404")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("METHOD_NOT_ALLOWED")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("405")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("NOT_ACCEPTABLE")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("406")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("GONE")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("410")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("UNPROCESSABLE_ENTITY")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("422")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("SERVER_ERROR")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("500")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("BAD_GATEWAY")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("502")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("SERVICE_UNAVAILABLE")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("503")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("GATEWAY_TIMEOUT")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("504")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h4",{attrs:{id:"业务状态码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#业务状态码"}},[t._v("#")]),t._v(" 业务状态码")]),t._v(" "),a("ul",[a("li",[t._v("这个跟后端同学一起约定好")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("SERVER_STATUS")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("SUCCEED_CODE")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 成功")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("SESSION_TIMEOUT")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 会话超时，请重新登录")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("NOT_REGISTER")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 用户未注册")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("REFRESH_TOKEN_EXPIRED")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 主Token已失效")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("INVALID_ACCESS_TOKEN")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// accessToken无法解析")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h3",{attrs:{id:"添加自定义拦截器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#添加自定义拦截器"}},[t._v("#")]),t._v(" 添加自定义拦截器")]),t._v(" "),a("ul",[a("li",[t._v("统一在"),a("code",[t._v("header")]),t._v("中添加埋点参数和"),a("code",[t._v("token")]),t._v("。")]),t._v(" "),a("li",[t._v("对不同环境，比如本地、"),a("code",[t._v("mock")]),t._v("、"),a("code",[t._v("development")]),t._v("、"),a("code",[t._v("production")]),t._v("的调用，适配不同的"),a("code",[t._v("baseUrl")]),t._v("。需要在启动服务的时候，传入不同的参数，例如"),a("code",[t._v("dev")]),t._v("环境，传入"),a("code",[t._v("TARO_APP_API=dev")])]),t._v(" "),a("li",[t._v("对请求返回值做统一的判断处理，对于返回异常的结果做统一处理。")])]),t._v(" "),a("h2",{attrs:{id:"问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#问题"}},[t._v("#")]),t._v(" 问题")]),t._v(" "),a("h3",{attrs:{id:"小程序中打开web页面"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#小程序中打开web页面"}},[t._v("#")]),t._v(" 小程序中打开web页面")]),t._v(" "),a("ul",[a("li",[t._v("由于小程序的主包大小是有限的，一些页面仅H5就能满足需求，就没有同时开发小程序版，但是在跳转的时候，针对这些url需要使用"),a("code",[t._v("weburl")]),t._v("的方式打开。在配置跳转链接的时候，就需要非常小心，否则在小程序端将无法浏览。")]),t._v(" "),a("li",[t._v("还有一种情况，是一些页面是通过搭建工具生产出来的，在小程序端也只能使用"),a("code",[t._v("weburl")]),t._v("的方式打开。")]),t._v(" "),a("li",[t._v("以上两种情况，很容易跟"),a("code",[t._v("Taro")]),t._v("的路由混淆。这些链接的场景，可能是在运营后台配置的，可能是服务端拼接后返回的，也能是前端在代码中拼接的，需要非常小心。")]),t._v(" "),a("li",[t._v("最好是有一份"),a("code",[t._v("weburl")]),t._v("的文档维护，知晓相关产品、运营、开发同学，否则很容易造成事故。")])]),t._v(" "),a("h3",{attrs:{id:"scrollview的局限性"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#scrollview的局限性"}},[t._v("#")]),t._v(" "),a("code",[t._v("ScrollView")]),t._v("的局限性")]),t._v(" "),a("ul",[a("li",[t._v("大促页面中，常见的模块组成是顶部"),a("code",[t._v("banner")]),t._v(" + 导航 + 底部的商品楼层。当页面滚动一部分距离后，需要将导航固定在头部，方便用户切换楼层。")]),t._v(" "),a("li",[t._v("我们使用了"),a("code",[t._v("ScrollView")]),t._v("作为承载商品楼层的容器，如果容器中有"),a("code",[t._v("position:fixed")]),t._v("的元素，比如导航，会出现样式错位的bug。")]),t._v(" "),a("li",[t._v("解决方案，写两份导航，当需要"),a("code",[t._v("fixed")]),t._v("的时候，用外层的导航盖在"),a("code",[t._v("ScrollView")]),t._v("上面。")])]),t._v(" "),a("h3",{attrs:{id:"刘海屏适配"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#刘海屏适配"}},[t._v("#")]),t._v(" 刘海屏适配")]),t._v(" "),a("ul",[a("li",[t._v("当应用需要全屏显示时才需要进行适配，常见场景：沉浸式体验，比如全屏直播。")]),t._v(" "),a("li",[a("code",[t._v('<meta name="viewport" content="viewport-fit=cover">')]),t._v("，设置之后，视图端口被缩放以填充设备显示。换句话说就是网页会扩展到整个屏幕。")]),t._v(" "),a("li",[a("code",[t._v("env()")]),t._v("，将用户代理定义的环境变量值插入你的 CSS 中。")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("body "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  padding"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("constant")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("safe"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("area"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("inset"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("top"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("constant")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("safe"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("area"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("inset"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("right"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("constant")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("safe"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("area"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("inset"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("bottom"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("constant")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("safe"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("area"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("inset"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("left"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* 兼容 iOS < 11.2 */")]),t._v("\n  padding"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("env")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("safe"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("area"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("inset"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("top"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("env")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("safe"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("area"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("inset"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("right"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("env")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("safe"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("area"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("inset"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("bottom"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("env")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("safe"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("area"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("inset"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("left"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* 兼容 iOS >= 11.2 */")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("ul",[a("li",[t._v("如果使用了原生导航栏，仅需要适配底部小黑条时，简单设置"),a("code",[t._v("safe-area-inset-bottom")]),t._v("就可以。")])]),t._v(" "),a("div",{staticClass:"language-css extra-class"},[a("pre",{pre:!0,attrs:{class:"language-css"}},[a("code",[a("span",{pre:!0,attrs:{class:"token selector"}},[t._v("body")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v("padding-bottom")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("constant")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("safe-area-inset-bottom"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v("padding-bottom")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("env")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("safe-area-inset-bottom"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("h2",{attrs:{id:"总结"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[t._v("#")]),t._v(" 总结")]),t._v(" "),a("ul",[a("li",[t._v("如果业务需要同时支持H5和小程序端，需要提前规划好主包内容，必须是核心、基础的内容，然后要考虑首屏加载的组件，比如首页，瀑布流组件等")]),t._v(" "),a("li",[t._v("Taro H5 路由支持简写，但小程序中的路径是需要写完整的路径的，推荐使用完整路径，不需要搞两套，维护起来比较麻烦。")]),t._v(" "),a("li",[t._v("对于H5 和 小程序 UI 相差较大的页面，建议用两个页面分别作为页面入口，不要在一个页面中写兼容的逻辑。")]),t._v(" "),a("li",[t._v("跟客户端的路径一定要统一，统一的好处是，如果在客户端扫码打开某个H5页面，可以直接映射到对应的客户端页面。另外，跳转的参数也需要统一。")]),t._v(" "),a("li",[t._v("对于UI展示有规律的模块，比如"),a("code",[t._v("个人中心")]),t._v("的各个模块入口，或者"),a("code",[t._v("首页")]),t._v("的入口，尽量设计为可数据配置，这样可以减少客户端的发版次数。")]),t._v(" "),a("li",[t._v("客户端的大版本号尽量保持一致发布。")])]),t._v(" "),a("h2",{attrs:{id:"参考"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考"}},[t._v("#")]),t._v(" 参考")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/CSS/env()",target:"_blank",rel:"noopener noreferrer"}},[t._v("env"),a("OutboundLink")],1)])])])}),[],!1,null,null,null);s.default=e.exports}}]);