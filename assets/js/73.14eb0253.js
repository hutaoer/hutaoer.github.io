(window.webpackJsonp=window.webpackJsonp||[]).push([[73],{507:function(e,a,v){"use strict";v.r(a);var _=v(2),s=Object(_.a)({},(function(){var e=this,a=e._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"schema动态路由建设"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#schema动态路由建设"}},[e._v("#")]),e._v(" schema动态路由建设")]),e._v(" "),a("h2",{attrs:{id:"背景-目的"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#背景-目的"}},[e._v("#")]),e._v(" 背景/目的")]),e._v(" "),a("p",[e._v("1.解决多个端 对于同一页面的实现类型不一样,比如日记详情页在患者app上是h5,在小程序上是原生."),a("br"),e._v("2.解决多个端 对于同一页面 页面路径的不同,比如app天生没有页面路径的概念,小程序和app端的页面路径也不可能必须保持统一")]),e._v(" "),a("h2",{attrs:{id:"方案介绍"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#方案介绍"}},[e._v("#")]),e._v(" 方案介绍")]),e._v(" "),a("p",[e._v("以页面为维度,每一个页面对应这一个schema,将schema的解析规则沉淀下来,在swan上进行配置,然后各个端启动的时候，更新下载此配置.")]),e._v(" "),a("h3",{attrs:{id:"解析规则介绍"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#解析规则介绍"}},[e._v("#")]),e._v(" 解析规则介绍")]),e._v(" "),a("ul",[a("li",[e._v("配置表可视化操作界面")]),e._v(" "),a("li",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/hutaoer/images/1667826392191-94d2269b-c93c-4782-aa88-b0858073929a.png",alt:"image.png"}})]),e._v(" "),a("li",[e._v("小程序/app获得的解析单条规则数据结构")]),e._v(" "),a("li",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/hutaoer/images/1667887499600-9abd02a7-2d86-4277-ab50-f26392dac5e8.png",alt:"image.png"}})]),e._v(" "),a("li",[e._v("每个端对应一套规则配置表")]),e._v(" "),a("li",[a("code",[e._v("schema")]),e._v(" 为该条记录的主键,用来匹配"),a("code",[e._v("schema")]),e._v("的规则")]),e._v(" "),a("li",[a("code",[e._v("schemeType")]),e._v("代表"),a("code",[e._v("schema")]),e._v("跳转类型,不同页面类型 对应的路径不一样,比如"),a("code",[e._v("h5")]),e._v("的是网址,"),a("code",[e._v("miniPage")]),e._v("对应的是小程序路径,"),a("code",[e._v("extMini")]),e._v("代表打开其他小程序,路径就代表其他小程序的路径")]),e._v(" "),a("li",[e._v("路径"),a("code",[e._v("(target)")]),e._v("代表"),a("code",[e._v("schema")]),e._v("对应页面的路径")]),e._v(" "),a("li",[e._v("额外参数放着是元数据给终端解析的逻辑关键字段"),a("br"),e._v("包含"),a("code",[e._v("schemeType")]),e._v("(代表跳转类型:原生页面 h5页面 打开其他小程序),"),a("br"),a("code",[e._v("appId")]),e._v("("),a("code",[e._v("schemeType")]),e._v("为"),a("code",[e._v("extMini")]),e._v("时用),"),a("code",[e._v("Base_Api")]),e._v("存着是对应的域名("),a("code",[e._v("schemeType")]),e._v("为h5时且是我们自己的h5然后路径填的是h5的相对路径,这样做的好处是能够读取客户端存的开发预发线上环境域名),"),a("br"),a("code",[e._v("needLogin:boolean")]),e._v("代表scheme跳转前是否需要登录,"),a("br"),a("code",[e._v("notFinalTarget:boolean")]),e._v("代表是否target为中转页,即跳转的时候直接将原本schema作为参数传递给这个页面就好(一般用在一个活动在海心健康露出,这个schema在小程序点击直接跳到活动页,在app里点击是打开海心健康的这个活动页).")]),e._v(" "),a("li",[a("code",[e._v("rules")]),e._v("代表"),a("code",[e._v("key")]),e._v("值映射,例如"),a("code",[e._v('{"userId":"userid"}')]),e._v(",即把schema原来自带的"),a("code",[e._v("userIdkey")]),e._v("值 真正转化后key值 为"),a("code",[e._v("userid")])])]),e._v(" "),a("h3",{attrs:{id:"解析流程介绍"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#解析流程介绍"}},[e._v("#")]),e._v(" 解析流程介绍")]),e._v(" "),a("ul",[a("li",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/hutaoer/images/20230912164043.png",alt:"image"}})])]),e._v(" "),a("h2",{attrs:{id:"功能清单-关键词"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#功能清单-关键词"}},[e._v("#")]),e._v(" 功能清单/关键词")]),e._v(" "),a("ol",[a("li",[e._v("动态添加:新schema swan上动态添加,添加后小程序在每次进入前台时更新/app在每次进入首页时更新")]),e._v(" "),a("li",[e._v("一个schema多端公用,且跳转方式多端可以多样")]),e._v(" "),a("li",[e._v("可以允许页面跳转需登录的前置校验")]),e._v(" "),a("li",[e._v("允许不同端实现的页面带的参数key不一致,允许参数在path上而不在query上")])]),e._v(" "),a("h2",{attrs:{id:"注意"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#注意"}},[e._v("#")]),e._v(" 注意")]),e._v(" "),a("ol",[a("li",[e._v("添加新schema的时候注意下是否有重复添加,即之前是否有加过")]),e._v(" "),a("li",[e._v("若此schema没有多端复用即这个页面不会出现在多端上,就不用添加schema,使用"),a("code",[e._v("openMini?mini_path=xx&mini_id=xx,h5?url=xx")]),e._v(" 或者直接"),a("code",[e._v("https://healthy.aistarfish.com/activity/a")]),e._v("也一样能达到跳转页面的效果,如在活动页 或者不是长期的业务页面 在自己页面内部跳转的时候(schema目前已经维护有太多).")]),e._v(" "),a("li",[e._v("由于目前"),a("code",[e._v("schema")]),e._v("测试环境没用起来,只有线上环境,所以线上操作时需谨慎")])])])}),[],!1,null,null,null);a.default=s.exports}}]);